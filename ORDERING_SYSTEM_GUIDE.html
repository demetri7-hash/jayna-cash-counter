<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ordering System - Staff Guide</title>
  <style>
    @page {
      margin: 0.4in;
      size: letter;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      font-size: 9pt;
      line-height: 1.3;
      color: #212121;
      max-width: 100%;
    }

    h1 {
      color: #2196F3;
      font-size: 18pt;
      margin-bottom: 8px;
      border-bottom: 2px solid #2196F3;
      padding-bottom: 4px;
    }

    h2 {
      color: #212121;
      font-size: 12pt;
      margin-top: 12px;
      margin-bottom: 6px;
      background: #f5f5f5;
      padding: 4px 8px;
      border-left: 3px solid #2196F3;
    }

    h3 {
      color: #424242;
      font-size: 10pt;
      margin-top: 8px;
      margin-bottom: 4px;
      font-weight: 600;
    }

    p {
      margin-bottom: 6px;
      text-align: justify;
    }

    ul, ol {
      margin-left: 18px;
      margin-bottom: 8px;
    }

    li {
      margin-bottom: 3px;
    }

    .box {
      background: #f9f9f9;
      border: 1px solid #e0e0e0;
      padding: 8px;
      margin: 8px 0;
      border-radius: 3px;
    }

    .highlight {
      background: #fff3cd;
      padding: 8px;
      border-left: 3px solid #ffc107;
      margin: 8px 0;
      font-size: 9pt;
    }

    .two-column {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 8px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 8px 0;
      font-size: 8pt;
    }

    th, td {
      border: 1px solid #e0e0e0;
      padding: 4px 6px;
      text-align: left;
    }

    th {
      background: #f5f5f5;
      font-weight: 600;
    }

    .step {
      background: #e3f2fd;
      padding: 6px 10px;
      margin: 4px 0;
      border-left: 3px solid #2196F3;
      font-size: 9pt;
    }

    strong {
      color: #212121;
      font-weight: 600;
    }

    .workflow-box {
      background: #f0f4f8;
      border: 2px solid #2196F3;
      padding: 10px;
      margin: 10px 0;
    }

    @media print {
      body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    }
  </style>
</head>
<body>

<h1>📦 Ordering System - Complete Staff Guide</h1>

<div class="highlight">
<strong>What is this?</strong> An AI-powered system that reads vendor invoices with your phone camera, automatically matches items to your inventory, learns from your corrections, and creates smart prep recommendations based on consumption patterns.
</div>

<h2>🎯 System Overview: Three Tabs</h2>

<p>The Ordering System has three main tabs you'll work with:</p>

<table>
  <tr>
    <th>Tab</th>
    <th>Purpose</th>
    <th>When to Use</th>
  </tr>
  <tr>
    <td><strong>STOCK</strong></td>
    <td>View all inventory items with current levels</td>
    <td>Check stock status, see what's low/good</td>
  </tr>
  <tr>
    <td><strong>ORDERS</strong></td>
    <td>Upload invoices + AI matching</td>
    <td>Receiving deliveries OR placing orders</td>
  </tr>
  <tr>
    <td><strong>PREP</strong></td>
    <td>Smart prep recommendations</td>
    <td>Planning what to make today/this week</td>
  </tr>
</table>

<h2>📋 Tab 1: STOCK - Inventory View</h2>

<p>This tab shows your complete inventory at a glance:</p>

<h3>What You See:</h3>
<ul>
  <li><strong>Item Name:</strong> What the item is (e.g., "SALAD MIX", "HUMMUS")</li>
  <li><strong>Current Stock:</strong> How much you have right now (e.g., "4 CAMBRO")</li>
  <li><strong>Par Level:</strong> Minimum amount you should keep (e.g., "8 CAMBRO")</li>
  <li><strong>Status Badge:</strong> Color-coded status (LOW = red, MEDIUM = orange, GOOD = green)</li>
  <li><strong>Last Counted:</strong> Time since last inventory count (e.g., "2h ago", "1d ago")</li>
</ul>

<h3>Status Meanings:</h3>
<div class="box">
<strong>LOW (Red):</strong> Stock below 30% of par → Order immediately<br>
<strong>MEDIUM (Orange):</strong> Stock 30-70% of par → Order soon<br>
<strong>GOOD (Green):</strong> Stock above 70% of par → Adequate stock
</div>

<p><strong>Pro Tip:</strong> Use this tab for quick visual check before ordering. If you see lots of red/orange, you need to place an order.</p>

<h2>📸 Tab 2: ORDERS - AI Invoice Processing</h2>

<p>This is where the magic happens. The system uses AI to read invoices and match items automatically.</p>

<h3>Complete Workflow (Step-by-Step):</h3>

<div class="step"><strong>STEP 1: CHOOSE MODE</strong><br>
At the top, select what you're doing:
<ul style="margin-top: 4px;">
  <li><strong>RECONCILE INVOICE:</strong> You received a delivery, checking items in</li>
  <li><strong>PLACE ORDER:</strong> You're creating an order to send to vendor</li>
</ul>
</div>

<div class="step"><strong>STEP 2: UPLOAD IMAGE</strong><br>
Two options:
<ul style="margin-top: 4px;">
  <li><strong>TAKE PHOTO:</strong> Use phone/tablet camera for quick photo</li>
  <li><strong>UPLOAD:</strong> Choose existing image from device</li>
</ul>
<em>Tip: Make sure invoice is flat, well-lit, and text is clear</em>
</div>

<div class="step"><strong>STEP 3: PREVIEW & SCAN</strong><br>
After upload, you'll see image preview. Click <strong>"SCAN & EXTRACT"</strong> button.<br>
<em>System uses Tesseract OCR to read all text from image (takes 5-15 seconds)</em>
</div>

<div class="step"><strong>STEP 4: REVIEW EXTRACTED ITEMS</strong><br>
System finds line items and tries to match them to your inventory. Each item shows:
<ul style="margin-top: 4px;">
  <li><strong>Detected Name:</strong> What was read from invoice</li>
  <li><strong>Quantity:</strong> Amount found (e.g., "QTY: 2")</li>
  <li><strong>Match Status:</strong> Confidence % if matched (darker = better match)</li>
  <li><strong>Price:</strong> If detected from invoice</li>
</ul>
</div>

<div class="step"><strong>STEP 5: HANDLE EACH ITEM</strong><br>
For each extracted item, you have options:
<ul style="margin-top: 4px;">
  <li><strong>Accept Match:</strong> If confidence is high (70%+), item is auto-matched</li>
  <li><strong>MATCH Button:</strong> If low confidence, click to manually match</li>
  <li><strong>ADD NEW Button:</strong> If item doesn't exist in inventory yet</li>
  <li><strong>SKIP Button:</strong> If item not relevant (e.g., delivery fee, tax)</li>
</ul>
</div>

<div class="step"><strong>STEP 6: FINALIZE</strong><br>
Once all items are matched/skipped, click final button:
<ul style="margin-top: 4px;">
  <li><strong>"CHECK IN ALL ITEMS":</strong> For reconciliation mode (updates stock)</li>
  <li><strong>"SAVE ORDER":</strong> For order mode (saves pending order)</li>
</ul>
</div>

<h3>🧠 How the AI Matching Works:</h3>

<div class="workflow-box">
<strong>The Learning System (Gets Smarter Over Time):</strong>

<p style="margin-top: 8px;"><strong>First Time You See an Invoice Item:</strong></p>
<ol style="font-size: 8pt; margin-left: 16px;">
  <li>System reads: "Organic Arugula 5# Case"</li>
  <li>AI tries fuzzy matching against inventory (word-by-word comparison)</li>
  <li>Best guess: "ARUGULA" inventory item (68% confidence)</li>
  <li>Shows as low confidence → you click MATCH to confirm or correct</li>
  <li>You select correct item from list → <strong>System saves this as "learned alias"</strong></li>
</ol>

<p style="margin-top: 8px;"><strong>Second Time You See Same Invoice Item:</strong></p>
<ol style="font-size: 8pt; margin-left: 16px;">
  <li>System reads: "Organic Arugula 5# Case"</li>
  <li>Checks learned aliases first → ✅ Found! Matched to "ARUGULA"</li>
  <li>Shows 100% confidence (learned match)</li>
  <li>No manual work needed → auto-accepted</li>
</ol>

<p style="margin-top: 8px;"><strong>Result:</strong> First invoice takes 5 minutes to match items. Same invoice next week takes 30 seconds.</p>
</div>

<h3>Confidence Badge Colors:</h3>
<table>
  <tr>
    <th>Confidence</th>
    <th>Badge Color</th>
    <th>Meaning</th>
    <th>Action Needed</th>
  </tr>
  <tr>
    <td>100%</td>
    <td>Dark gray/black</td>
    <td>Learned alias match</td>
    <td>None - auto-accepted</td>
  </tr>
  <tr>
    <td>70-99%</td>
    <td>Dark gray</td>
    <td>Strong fuzzy match</td>
    <td>Verify if needed</td>
  </tr>
  <tr>
    <td>50-69%</td>
    <td>Medium gray</td>
    <td>Weak match</td>
    <td>Click MATCH to confirm</td>
  </tr>
  <tr>
    <td>0-49%</td>
    <td>Light gray</td>
    <td>No good match found</td>
    <td>Click MATCH or ADD NEW</td>
  </tr>
</table>

<h3>Manual Matching Process:</h3>
<p>When you click <strong>MATCH</strong> button on an item:</p>

<ol>
  <li>Modal pops up showing detected item name</li>
  <li>Search box to filter inventory items</li>
  <li>List of all inventory items with units</li>
  <li>Click the correct item → Match saved</li>
  <li>Item confidence becomes 100% (learned)</li>
  <li>Modal closes, item shows matched status</li>
</ol>

<div class="box">
<strong>Alternative: CREATE NEW</strong><br>
If invoice item doesn't exist in inventory, click <strong>CREATE NEW</strong>:
<ul style="margin-top: 4px; font-size: 8pt;">
  <li>Enter item name (defaults to detected name)</li>
  <li>Choose vendor from list</li>
  <li>Enter unit (CS, EA, LB, etc.)</li>
  <li>Set par level (or 0 to set later)</li>
  <li>Choose if it's a PREP item</li>
  <li>New item created in inventory + matched</li>
</ul>
</div>

<h2>🔪 Tab 3: PREP - Smart Recommendations</h2>

<p>This tab focuses specifically on <strong>PREP items</strong> (items you make in-house like salads, hummus, dressings, etc.)</p>

<h3>What You See:</h3>
<ul>
  <li><strong>Count Session Info:</strong> Current active count session (if any)</li>
  <li><strong>Priority Groups:</strong> Items grouped by urgency (URGENT → HIGH → MEDIUM → LOW)</li>
  <li><strong>For Each Item:</strong> Current stock, par level, recommended amount, reasoning</li>
</ul>

<h3>How Recommendations Work:</h3>

<div class="workflow-box">
<strong>Data Sources:</strong>
<ol style="font-size: 8pt; margin-left: 16px; margin-top: 6px;">
  <li><strong>Current Stock:</strong> From your latest count</li>
  <li><strong>Par Level:</strong> Your target minimum</li>
  <li><strong>Last 7 Days Consumption:</strong> How much used per count session</li>
  <li><strong>Time Since Last Count:</strong> Hours/days ago</li>
</ol>

<strong style="display: block; margin-top: 10px;">Recommendation Logic:</strong>
<ul style="font-size: 8pt; margin-left: 16px; margin-top: 4px;">
  <li>If OUT OF STOCK (0): Recommend at least par level OR 2x average consumption</li>
  <li>If LOW (&lt;50% of par): Recommend enough to reach par level</li>
  <li>If MEDIUM (50-75% of par): Recommend 1.5x average consumption rate</li>
  <li>If GOOD (75-100% of par): No urgent action, maybe small prep</li>
</ul>
</div>

<h3>Priority Assignment Rules:</h3>

<table>
  <tr>
    <th>Priority</th>
    <th>Trigger Conditions</th>
    <th>Example Reasoning</th>
  </tr>
  <tr>
    <td><strong>URGENT</strong></td>
    <td>Stock = 0 OR Stock &lt; 50% of par</td>
    <td>"Out of stock - make immediately"<br>"Stock below 50% (28%)"</td>
  </tr>
  <tr>
    <td><strong>HIGH</strong></td>
    <td>Stock 50-75% of par</td>
    <td>"Stock at 62%, consuming 3.2/session"</td>
  </tr>
  <tr>
    <td><strong>MEDIUM</strong></td>
    <td>Stock 75-100% + actively consuming</td>
    <td>"Stock at 83%, consuming 1.8/session"</td>
  </tr>
  <tr>
    <td><strong>LOW</strong></td>
    <td>Stock &gt;100% of par OR slow consumption</td>
    <td>"Stock good (115%)"</td>
  </tr>
</table>

<h3>Consumption Tracking (How It Learns):</h3>

<div class="box">
<strong>Every time you complete a count session:</strong><br>
System compares current stock to previous count → calculates consumption:

<p style="margin-top: 6px; font-size: 8pt;"><strong>Monday AM Count:</strong> 10 CAMBRO of salad mix<br>
<strong>Tuesday AM Count:</strong> 6 CAMBRO of salad mix<br>
<strong>→ System learns:</strong> Consumed 4 CAMBRO in one day</p>

<p style="margin-top: 6px; font-size: 8pt;">After 5-7 counts, system calculates average consumption rate:<br>
<strong>Average:</strong> 3.5 CAMBRO per day</p>

<p style="margin-top: 6px; font-size: 8pt;"><strong>Smart Recommendation:</strong><br>
If current stock = 2 CAMBRO and par = 8 CAMBRO:<br>
Basic math: 8 - 2 = 6 CAMBRO needed<br>
<strong>But AI considers:</strong> "You use 3.5/day, and today is Thursday (busy weekend coming)"<br>
<strong>→ Recommends:</strong> 8-10 CAMBRO (enough to reach par + buffer for busy period)</p>
</div>

<h3>Using the Prep Tab Effectively:</h3>

<ol>
  <li><strong>Daily Check:</strong> Open PREP tab every morning</li>
  <li><strong>Focus on URGENT:</strong> Make these items first</li>
  <li><strong>Plan HIGH:</strong> Schedule these for today/tomorrow</li>
  <li><strong>Note MEDIUM:</strong> Add to your mental prep list</li>
  <li><strong>Ignore LOW:</strong> These are fine, focus on priorities</li>
  <li><strong>Trust Recommendations:</strong> After 2-3 weeks, AI knows your patterns</li>
</ol>

<h2>💡 Best Practices for Optimal Results</h2>

<h3>For Invoice Scanning (ORDERS Tab):</h3>
<div class="two-column">
  <div>
    <h4>✅ DO:</h4>
    <ul style="font-size: 8pt;">
      <li>Take clear, flat photos</li>
      <li>Good lighting (no shadows)</li>
      <li>Correct low-confidence matches first time</li>
      <li>Skip irrelevant items (fees, notes)</li>
      <li>Use same invoice format from vendors</li>
    </ul>
  </div>
  <div>
    <h4>❌ DON'T:</h4>
    <ul style="font-size: 8pt;">
      <li>Photograph crumpled/wet invoices</li>
      <li>Scan handwritten notes</li>
      <li>Accept obviously wrong matches</li>
      <li>Create duplicate inventory items</li>
      <li>Skip the learning process</li>
    </ul>
  </div>
</div>

<h3>For Prep Recommendations (PREP Tab):</h3>
<div class="two-column">
  <div>
    <h4>✅ DO:</h4>
    <ul style="font-size: 8pt;">
      <li>Count consistently (same time daily)</li>
      <li>Complete full count sessions</li>
      <li>Trust recommendations after 2-3 weeks</li>
      <li>Update par levels seasonally</li>
      <li>Check prep tab before starting work</li>
    </ul>
  </div>
  <div>
    <h4>❌ DON'T:</h4>
    <ul style="font-size: 8pt;">
      <li>Skip count sessions</li>
      <li>Estimate stock numbers</li>
      <li>Ignore URGENT items</li>
      <li>Over-prep LOW priority items</li>
      <li>Forget to update counts after prep</li>
    </ul>
  </div>
</div>

<h2>❓ Common Questions</h2>

<h3>Q: Why did the system match "Organic Arugula 5# CS" to "LETTUCE"?</h3>
<p><strong>A:</strong> First-time fuzzy matching isn't perfect. Click MATCH, select the correct item (ARUGULA), and the system will remember forever. Next time = 100% correct.</p>

<h3>Q: What if the invoice has poor quality text?</h3>
<p><strong>A:</strong> OCR may miss items or read incorrectly. Manually add missing items using "ADD NEW" or re-take photo with better lighting.</p>

<h3>Q: How long until prep recommendations are accurate?</h3>
<p><strong>A:</strong> Basic accuracy: 3-5 count sessions. Full pattern recognition: 2-3 weeks of consistent counting.</p>

<h3>Q: Can I edit a recommendation before prepping?</h3>
<p><strong>A:</strong> The prep tab is read-only (shows recommendations). Make the prep, then update your count to reflect new stock. The system learns from your actual behavior.</p>

<h3>Q: What happens if I skip a day of counting?</h3>
<p><strong>A:</strong> Consumption calculation for that period will be inaccurate, but system adapts. Try to count daily for best results.</p>

<h3>Q: Do I need to match EVERY item on an invoice?</h3>
<p><strong>A:</strong> No. Skip items that aren't inventory (delivery fees, tax, promotional text). Focus on actual products.</p>

<h3>Q: Can multiple people use the ordering system?</h3>
<p><strong>A:</strong> Yes! All learned matches are saved to database and available to everyone. The more you use it, the smarter it gets for the whole team.</p>

<div class="highlight" style="margin-top: 12px;">
<strong>🎓 Remember:</strong> This system combines OCR (reads invoices), AI (matches items), and machine learning (remembers corrections + consumption patterns). The first week requires training time (correcting matches, consistent counting). After that, it becomes faster than manual work and catches patterns humans miss. Trust the process and stay consistent!
</div>

</body>
</html>
